
<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>HOTKEY QUIZ</title>
<style>
    body {
        font-family: 'Segoe UI', sans-serif;
        background: linear-gradient(135deg, #4facfe, #00f2fe);
        color: #fff;
        text-align: center;
        margin: 0;
        padding: 0;
    }
    .container {
        max-width: 600px;
        margin: 80px auto;
        background: rgba(0, 0, 0, 0.4);
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 8px 16px rgba(0,0,0,0.3);
    }
    h1 { font-size: 28px; margin-bottom: 20px; }
    #question { font-size: 25px; margin-bottom: 20px; }
    #result { font-size: 20px; margin-top: 15px; }
    #score { font-size: 22px; margin-top: 20px; font-weight: bold; }
    .hint { font-size: 20px; margin-top: 20px; color: #ddd; }
    #restartBtn {
        margin-top: 25px;
        padding: 10px 20px;
        font-size: 18px;
        background-color: #00f2fe;
        color: #000;
        border: none;
        border-radius: 8px;
        cursor: pointer;
    }
    #restartBtn:hover {
        background-color: #4facfe;
        color: #fff;
    }
</style>
</head>
<body>
<div class="container">
    <h1>ENSITE HOTKEY QUIZ</h1>
    <div id="question"></div>
    <div class="hint">※ 実際にキーを押してください <br>（F1~12の場合はfnキーも押してください）</div>
    <div id="result"></div>
    <div id="score"></div>
    <button id="restartBtn" style="display:none;">もう一度挑戦</button>
</div>

<script>
const questions = [
    { q: "イベントを保存", a: "Control+E" },
    { q: "Bookmarkを保存", a: "Control+B" },
    { q: "Studyの終了", a: "Control+Q" },
    { q: "ヘルプダイアログの表示", a: "F1" },
    { q: "スプリットスクリーンをシンクロ", a: "F3" },
    { q: "Voxelポイントの表示/非表示", a: "Control+K" },
    { q: "呼吸データの収集", a: "Alt+R" },
    { q: "セグメントの記録", a: "F4" },
    { q: "2Dリージョンを追加", a: "F6" },
    { q: "3Dリージョンを追加", a: "Shift+F6" },
    { q: "APを中心に後方に回転", a: "W" },
    { q: "APを中心に前方に回転", a: "S" },
    { q: "APを中心とした左方向への回転", a: "A" },
    { q: "APを中心とした右方向への回転", a: "D" },
    { q: "消しゴムツールのサンドペーパーによる補正", a: "F2" },
    { q: "消しゴムツールの種類の切替", a: "Z" },
    { q: "モデルポイント削除の取消", a: "Control+Z" },
    { q: "モデルの作成/AutoMapによるデータ収集の停止", a: "F9" },
    { q: "Mapping PointのFreeze/保存", a: "F11" },
    { q: "現在のMapping Pointの破棄", a: "F12" },
    { q: "AutoMapの開始/停止", a: "Shift+F11" },
    { q: "1拍前のビートバッファに戻る", a: "ArrowLeft" },
    { q: "1拍後のビートバッファに進む", a: "ArrowRight" },
    { q: "ツールリストを開く/閉じる", a: "O" },
    { q: "ローテート/パン", a: "R" },
    { q: "ポインター", a: "P" },
    { q: "Shadowツールを開く", a: "H" },
    { q: "モデル上にShadowを付ける", a: "F5" },
    { q: "Markerツールを開く", a: "M" },
    { q: "Tape Measureツールを開く", a: "T" },
    { q: "Caliperツールを開く", a: "C" },
    { q: "Labelツールを開く", a: "B" },
    { q: "Lesionツールを開く", a: "L" },
    { q: "すべてのポイントを選択", a: "Control+A" },
    { q: "選択されたポイントを削除", a: "Delete" },
    { q: "ポイントグループを削除", a: "Alt+Delete" },
];

let shuffled = [];
let index = 0;
let score = 0;
let pressedKeys = new Set();
let comboHistory = [];

function startQuiz() {
    shuffled = questions.sort(() => Math.random() - 0.5).slice(0, 10);
    index = 0;
    score = 0;
    document.getElementById("score").textContent = "";
    document.getElementById("restartBtn").style.display = "none";
    showQuestion();
    document.addEventListener("keydown", handleKeyDown);
    document.addEventListener("keyup", handleKeyUp);
}

function showQuestion() {
    if (index < shuffled.length) {
        document.getElementById("question").textContent = `問題 ${index+1}: ${shuffled[index].q}`;
        document.getElementById("result").textContent = "";
        pressedKeys.clear();
        comboHistory = [];
    } else {
        document.getElementById("question").textContent = "テスト終了！";
        document.getElementById("score").textContent = `あなたのスコア: ${score}/${shuffled.length}`;
        document.removeEventListener("keydown", handleKeyDown);
        document.removeEventListener("keyup", handleKeyUp);
        document.getElementById("restartBtn").style.display = "inline-block";
    }
}

function handleKeyDown(e) {
    e.preventDefault();
    pressedKeys.add(e.code);
    if (!comboHistory.includes(e.code)) {
        comboHistory.push(e.code);
    }
}

function handleKeyUp(e) {
    pressedKeys.delete(e.code);
    if (pressedKeys.size === 0) {
        const combo = [];
        if (comboHistory.includes("ControlLeft") || comboHistory.includes("ControlRight")) combo.push("Control");
        if (comboHistory.includes("ShiftLeft") || comboHistory.includes("ShiftRight")) combo.push("Shift");
        if (comboHistory.includes("AltLeft") || comboHistory.includes("AltRight")) combo.push("Alt");

        const nonModifierKeys = comboHistory.filter(k => !k.includes("Control") && !k.includes("Shift") && !k.includes("Alt"));
        if (nonModifierKeys.length > 0) {
            const lastKey = nonModifierKeys[nonModifierKeys.length - 1];
            const formattedKey = lastKey.replace("Key", "").replace("Digit", "");
            combo.push(formattedKey);
        }

        const pressed = combo.join("+");
        const correctAnswer = shuffled[index].a;

        if (pressed === correctAnswer) {
            document.getElementById("result").textContent = "✅ 正解！";
            document.getElementById("result").style.color = "lime";
            score++;
        } else {
            document.getElementById("result").innerHTML = `❌ 不正解。押したキー: ${pressed} <br> 正解: ${correctAnswer}`;
            document.getElementById("result").style.color = "pink";
        }

        index++;
        setTimeout(showQuestion, 2000);
        comboHistory = [];
    }
}

document.getElementById("restartBtn").addEventListener("click", startQuiz);
startQuiz();
</script>
</body>
</html>

